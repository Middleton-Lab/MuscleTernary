<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MuscleTernary">
<title>Working with stl files • MuscleTernary</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with stl files">
<meta property="og:description" content="MuscleTernary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MuscleTernary</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/centroid.html">Working with stl files</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Working with stl files</h1>
            
      
      
      <div class="d-none name"><code>centroid.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="working-with-stl-files">Working with <code>stl</code> files<a class="anchor" aria-label="anchor" href="#working-with-stl-files"></a>
</h2>
<p>Stereolithography (<code>.stl</code>) files can be exported from most
segmentation software. In our workflow, usually there are two files for
each muscle, wherein the origin and insertion attachment areas of the
muscle are “mapped” onto the surface of a bone model (see Cost et al.,
2020, 2022; Wilken et al., 2019, 2020 for description).</p>
<p>There is no directionality to the calculation of either centroid size
or location, so either surface can be the “origin”. If you are
generating Maya mel code for generating a model + muscle vectors, then
the order matters to get the arrowhead on the correct end, however there
is a flag in <code><a href="../reference/make_mel.html">make_mel()</a></code> to reverse the arrows.</p>
<p>The <code>rgl</code> package has a function to import stl files:
<code>readSTL()</code>. <strong>Important</strong>: you should export
stl meshes as <em>binary, with little endian byte encoding</em>. If not,
you will get a cryptic error that will be very difficult to diagnose.
<code>MuscleTernary</code> has a wrapper function
<code><a href="../reference/read_stl.html">read_stl()</a></code> around the <code>rgl</code> function which
<em>should</em> catch any read errors, but it hasn’t been tested for all
possible cases (i.e., those I haven’t encountered yet).</p>
<p>The package includes a pair of stls for the left m. Pterygoideus
dorsalis (mPTm): <code>L_mPTd_Or.stl</code> and
<code>L_mPTd_Ins.stl</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MuscleTernary</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the local path to the stl file.</span></span>
<span><span class="va">stl_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                        <span class="st">"L_mPTd_Ins.stl"</span>,</span>
<span>                        package <span class="op">=</span> <span class="st">"MuscleTernary"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_stl.html">read_stl</a></span><span class="op">(</span><span class="va">stl_path</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/read_stl.html">read_stl()</a></code> returns a matrix with (x, y, z) coordinates
of the vertices of the triangles.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;           [,1]       [,2]      [,3]</span></span>
<span><span class="co">#&gt;  [1,] 80.15495 -11.792723 -570.9537</span></span>
<span><span class="co">#&gt;  [2,] 80.72946 -11.396370 -571.3650</span></span>
<span><span class="co">#&gt;  [3,] 79.95493 -11.389565 -571.5762</span></span>
<span><span class="co">#&gt;  [4,] 80.84564  -9.106031 -573.8356</span></span>
<span><span class="co">#&gt;  [5,] 80.04286  -9.215285 -573.6454</span></span>
<span><span class="co">#&gt;  [6,] 80.41844  -9.701449 -573.2871</span></span>
<span><span class="co">#&gt;  [7,] 80.15350 -10.181118 -572.8048</span></span>
<span><span class="co">#&gt;  [8,] 79.55407 -10.362929 -572.4216</span></span>
<span><span class="co">#&gt;  [9,] 80.77268 -10.513458 -572.4617</span></span>
<span><span class="co">#&gt; [10,] 80.15495 -11.792723 -570.9537</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="centroid-location-and-centroid-size">Centroid location and centroid size<a class="anchor" aria-label="anchor" href="#centroid-location-and-centroid-size"></a>
</h2>
<p>The centroid location (often just the “centroid”) of the mesh is
simply the mean of each column. To simply usage,
<code><a href="../reference/centroid_location.html">centroid_location()</a></code> takes a single argument with the string
path to the STL file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">stl</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   64.784475    8.529847 -567.928419</span></span>
<span></span>
<span><span class="fu"><a href="../reference/centroid_location.html">centroid_location</a></span><span class="op">(</span><span class="va">stl_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   64.784475    8.529847 -567.928419</span></span></code></pre></div>
<p>The size of the centroid is the 3D distance of each vertex from the
centroid.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the centroid</span></span>
<span><span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centroid_location.html">centroid_location</a></span><span class="op">(</span><span class="va">stl_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the distance formula</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">centroid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">stl</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span></span>
<span>           <span class="op">(</span><span class="va">centroid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">stl</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span></span>
<span>           <span class="op">(</span><span class="va">centroid</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">stl</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2576.131</span></span>
<span></span>
<span><span class="fu"><a href="../reference/centroid_size.html">centroid_size</a></span><span class="op">(</span><span class="va">stl_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2576.131</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Cost IN, Middleton KM, Sellers KC, Echols MS, Witmer LM, Davis JL,
Holliday CM. 2020. Palatal Biomechanics and Its Significance for Cranial
Kinesis in <em>Tyrannosaurus rex</em>. Anat Rec 303:999–1017.</p>
<p>Cost IN, Sellers KC, Rozin RE, Spates AT, Middleton KM, Holliday CM.
2022. 2D and 3D visualizations of archosaur jaw muscle mechanics,
ontogeny and phylogeny using ternary diagrams and 3D modeling. <a href="http://dx.doi.org/10.1242/jeb.243216" class="external-link">J Exp Biol 225</a></p>
<p>Wilken AT, Middleton KM, Sellers KC, Cost IN, Holliday CM. 2019. The
roles of joint tissues and jaw muscles in palatal biomechanics of the
Savannah monitor (<em>Varanus exanthematicus</em>) and their
significance for cranial kinesis. J Exp Biol 222:1–14.</p>
<p>Wilken AT, Sellers KC, Cost IN, Rozin RE, Middleton KM, Holliday CM.
2020. Connecting the chondrocranium: Biomechanics of the suspensorium in
reptiles. Vertebrate Zoology 70:275–290.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Middleton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
